{"version":3,"file":"render-template.js","sources":["../../../../../src/actions/drafter/lib/build-release-payload/render-template.ts"],"sourcesContent":["import { Config } from 'src/types'\n\nexport type Template = {\n  [key: `$${Uppercase<string>}`]:\n    | string\n    | number\n    | null\n    | undefined\n    | NestedTemplate\n}\nexport type NestedTemplate = {\n  template: string\n  [key: `$${Uppercase<string>}`]:\n    | string\n    | number\n    | null\n    | undefined\n    | NestedTemplate\n}\n\n/**\n * replaces all uppercase dollar templates with their string representation from object\n * if replacement is undefined in object the dollar template string is left untouched\n */\nexport const renderTemplate = (params: {\n  template: string\n  object: Template\n  replacers?: Config['replacers']\n}) => {\n  const { template, object, replacers } = params\n\n  let input = template.replace(/(\\$[A-Z_]+)/g, (_, k: string): string => {\n    let result\n\n    const isValidKey = (key: unknown): key is keyof typeof object =>\n      (key as keyof typeof object) in object &&\n      object[key as keyof typeof object] !== undefined &&\n      object[key as keyof typeof object] !== null\n\n    if (!isValidKey(k)) {\n      result = k\n    } else if (typeof object[k] === 'object') {\n      result = renderTemplate({\n        template: object[k]!.template,\n        object: object[k]!\n      })\n    } else {\n      result = `${object[k]}`\n    }\n    return result\n  })\n\n  if (replacers) {\n    for (const { search, replace } of replacers) {\n      input = input.replace(search, replace)\n    }\n  }\n\n  return input\n}\n"],"names":[],"mappings":"AAwBO,MAAM,iBAAiB,CAAC,WAIzB;AACJ,QAAM,EAAE,UAAU,QAAQ,UAAA,IAAc;AAExC,MAAI,QAAQ,SAAS,QAAQ,gBAAgB,CAAC,GAAG,MAAsB;AACrE,QAAI;AAEJ,UAAM,aAAa,CAAC,QACjB,OAA+B,UAChC,OAAO,GAA0B,MAAM,UACvC,OAAO,GAA0B,MAAM;AAEzC,QAAI,CAAC,WAAW,CAAC,GAAG;AAClB,eAAS;AAAA,IACX,WAAW,OAAO,OAAO,CAAC,MAAM,UAAU;AACxC,eAAS,eAAe;AAAA,QACtB,UAAU,OAAO,CAAC,EAAG;AAAA,QACrB,QAAQ,OAAO,CAAC;AAAA,MAAA,CACjB;AAAA,IACH,OAAO;AACL,eAAS,GAAG,OAAO,CAAC,CAAC;AAAA,IACvB;AACA,WAAO;AAAA,EACT,CAAC;AAED,MAAI,WAAW;AACb,eAAW,EAAE,QAAQ,QAAA,KAAa,WAAW;AAC3C,cAAQ,MAAM,QAAQ,QAAQ,OAAO;AAAA,IACvC;AAAA,EACF;AAEA,SAAO;AACT;"}