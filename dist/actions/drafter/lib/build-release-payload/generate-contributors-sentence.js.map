{"version":3,"file":"generate-contributors-sentence.js","sources":["../../../../../src/actions/drafter/lib/build-release-payload/generate-contributors-sentence.ts"],"sourcesContent":["import { Config } from 'src/types'\nimport { findPullRequests } from '../find-pull-requests'\n\nexport const generateContributorsSentence = (params: {\n  commits: Awaited<ReturnType<typeof findPullRequests>>['commits']\n  pullRequests: Awaited<ReturnType<typeof findPullRequests>>['pullRequests']\n  config: Pick<Config, 'exclude-contributors' | 'no-contributors-template'>\n}) => {\n  const { commits, pullRequests, config } = params\n\n  const contributors = new Set<string>()\n\n  // Add from commits\n  for (const commit of commits) {\n    if (commit.author?.user) {\n      if (!config['exclude-contributors'].includes(commit.author.user.login)) {\n        contributors.add(`@${commit.author.user.login}`)\n      }\n    } else if (commit.author?.name) {\n      contributors.add(commit.author.name)\n    }\n  }\n\n  // Add from pull requests\n  for (const pullRequest of pullRequests) {\n    if (\n      pullRequest.author &&\n      !config['exclude-contributors'].includes(pullRequest.author.login)\n    ) {\n      if (pullRequest.author.__typename === 'Bot') {\n        contributors.add(\n          `[${pullRequest.author.login}[bot]](${pullRequest.author.url})`\n        )\n      } else {\n        contributors.add(`@${pullRequest.author.login}`)\n      }\n    }\n  }\n\n  const sortedContributors = [...contributors].sort()\n  if (sortedContributors.length > 1) {\n    return (\n      sortedContributors.slice(0, -1).join(', ') +\n      ' and ' +\n      sortedContributors.slice(-1)\n    )\n  } else if (sortedContributors.length === 1) {\n    return sortedContributors[0]\n  } else {\n    return config['no-contributors-template']\n  }\n}\n"],"names":[],"mappings":"AAGO,MAAM,+BAA+B,CAAC,WAIvC;AACJ,QAAM,EAAE,SAAS,cAAc,OAAA,IAAW;AAE1C,QAAM,mCAAmB,IAAA;AAGzB,aAAW,UAAU,SAAS;AAC5B,QAAI,OAAO,QAAQ,MAAM;AACvB,UAAI,CAAC,OAAO,sBAAsB,EAAE,SAAS,OAAO,OAAO,KAAK,KAAK,GAAG;AACtE,qBAAa,IAAI,IAAI,OAAO,OAAO,KAAK,KAAK,EAAE;AAAA,MACjD;AAAA,IACF,WAAW,OAAO,QAAQ,MAAM;AAC9B,mBAAa,IAAI,OAAO,OAAO,IAAI;AAAA,IACrC;AAAA,EACF;AAGA,aAAW,eAAe,cAAc;AACtC,QACE,YAAY,UACZ,CAAC,OAAO,sBAAsB,EAAE,SAAS,YAAY,OAAO,KAAK,GACjE;AACA,UAAI,YAAY,OAAO,eAAe,OAAO;AAC3C,qBAAa;AAAA,UACX,IAAI,YAAY,OAAO,KAAK,UAAU,YAAY,OAAO,GAAG;AAAA,QAAA;AAAA,MAEhE,OAAO;AACL,qBAAa,IAAI,IAAI,YAAY,OAAO,KAAK,EAAE;AAAA,MACjD;AAAA,IACF;AAAA,EACF;AAEA,QAAM,qBAAqB,CAAC,GAAG,YAAY,EAAE,KAAA;AAC7C,MAAI,mBAAmB,SAAS,GAAG;AACjC,WACE,mBAAmB,MAAM,GAAG,EAAE,EAAE,KAAK,IAAI,IACzC,UACA,mBAAmB,MAAM,EAAE;AAAA,EAE/B,WAAW,mBAAmB,WAAW,GAAG;AAC1C,WAAO,mBAAmB,CAAC;AAAA,EAC7B,OAAO;AACL,WAAO,OAAO,0BAA0B;AAAA,EAC1C;AACF;"}